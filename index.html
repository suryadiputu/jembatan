<!DOCTYPE html>
<html>
<head>
<meta charset="utf-8"/>
<meta name="viewport" content="width=device-width, initial-scale=1.0">

<title>WebGIS Aset Jembatan</title>

<link rel="stylesheet"
href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css"/>

<link rel="stylesheet"
href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.css"/>

<link rel="stylesheet"
href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.Default.css"/>

<style>

html,body{
height:100%;
margin:0;
font-family:Arial;
}

#map{
height:100%;
}

.panel{

position:absolute;
top:15px;
left:50%;
transform:translateX(-50%);
z-index:1000;

background:white;
padding:14px;

border-radius:14px;

box-shadow:0 4px 15px rgba(0,0,0,0.25);

width:90%;
max-width:420px;
}

select{

width:100%;
padding:12px;
font-size:16px;
border-radius:8px;
border:1px solid #ccc;

margin-bottom:8px;

}

button{

width:100%;
padding:12px;
font-size:16px;

border-radius:8px;
border:none;

margin-top:6px;

}

.go{

background:#1e6bd6;
color:white;

}

.loc{

background:#1c8f4d;
color:white;

}

.popupTitle{

font-weight:bold;
font-size:18px;
margin-bottom:4px;

}

.gmaps{

color:white;
background:#1e6bd6;
padding:6px 10px;
border-radius:6px;
text-decoration:none;
display:inline-block;
margin-top:6px;
}

</style>

</head>

<body>

<div class="panel">

<select id="bridgeSelect">
<option>Pilih Jembatan</option>
</select>

<button class="go" onclick="goBridge()">GO</button>

<button class="loc" onclick="locateUser()">
Posisi Saat Ini
</button>

</div>

<div id="map"></div>


<script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>

<script src="https://unpkg.com/leaflet.markercluster@1.5.3/dist/leaflet.markercluster.js"></script>

<script>


var map = L.map('map').setView([-8.4,115.2],10);

L.tileLayer(
'https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png',
{
attribution:'Â© OpenStreetMap'
}).addTo(map);



var bridgeIcon = L.icon({

iconUrl:'bridge.png',

iconSize:[34,34],

iconAnchor:[17,34]

});



var clusterGroup = L.markerClusterGroup({

maxClusterRadius:50,

disableClusteringAtZoom:14

});


var bridges = [

{nama:"Jembatan A",lat:-8.5,lon:115.2},

{nama:"Jembatan B",lat:-8.4,lon:115.1},

{nama:"Jembatan C",lat:-8.6,lon:115.3}

];



var select = document.getElementById("bridgeSelect");


bridges.forEach(function(b,i){

var m = L.marker(
[b.lat,b.lon],
{icon:bridgeIcon}
);


var link =
"https://www.google.com/maps?q="
+b.lat+","+b.lon;


m.bindPopup(

"<div class='popupTitle'>"
+b.nama+
"</div>"+

"<a class='gmaps' target='_blank' href='"
+link+
"'>Open GMaps</a>"

);


clusterGroup.addLayer(m);



var opt = document.createElement("option");

opt.value=i;

opt.text=b.nama;

select.appendChild(opt);

});


map.addLayer(clusterGroup);



function goBridge(){

var i=select.value;

if(i==="Pilih Jembatan")return;

var b=bridges[i];

map.setView([b.lat,b.lon],17);

}



var userMarker;


function locateUser(){

map.locate({setView:true,maxZoom:17});

}


map.on('locationfound',function(e){

if(userMarker){

map.removeLayer(userMarker);

}

userMarker=L.marker(e.latlng)
.addTo(map)
.bindPopup("Posisi Anda")
.openPopup();

});


map.on('locationerror',function(){

alert("GPS tidak aktif");

});


</script>

</body>
</html>
